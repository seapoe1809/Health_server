<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DICOM Viewer</title>
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.png') }}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
</head>
<style>
  .play__button {
            width: 100px;
            padding: 10px 1.5rem;
            border-radius: 6px;
            background: turquoise;
            color: #000;
            font: "Poppins";
            font-size: var(--small-font-size);
            font-weight: var(--font-semi-bold);
            box-shadow: 0 6px 24px hsla(244, 75%, 48%, 0.3);
            margin-bottom: 1rem;
            margin-top: 1rem;
        }

</style>
<body>
<div id="loader" class="loader"><div class="spinner"></div></div>
<button class="done-button" onclick="window.close()" title="Close"><i class="fas fa-times"></i></button>

    <div style="text-align:center;">
        <!-- Updated src to include filename and initial slice index -->
        <img id="dicomImage" src="/summary/slice/{{ filename }}/0" alt="DICOM Image" style="max-width:100%;">
        <br>
        <input type="range" id="sliceSlider" min="0" max="{{ max_slice }}" value="0">
        <button class="play__button" id="playPauseBtn">Play</button>
    </div>
    <script>
    // Initialize page with animations from styles.css
    window.addEventListener('load', function() {
        document.body.classList.add('loaded');
        
        // Hide loader if it exists
        const loader = document.getElementById('loader');
        if (loader) {
            setTimeout(() => {
                loader.classList.add('hidden');
            }, 300);
        }
    });
    
        const filename = "{{ filename }}"; // Add filename to JavaScript
        const slider = document.getElementById('sliceSlider');
        const image = document.getElementById('dicomImage');
        const playPauseBtn = document.getElementById('playPauseBtn');
        let playInterval = null;

        slider.oninput = function() {
            // Updated image.src to include filename in the path
            image.src = `/dicom/slice/${filename}/` + this.value;
        }

        playPauseBtn.onclick = function() {
            if (playInterval) {
                clearInterval(playInterval);
                playInterval = null;
                playPauseBtn.textContent = 'Play';
            } else {
                playPauseBtn.textContent = 'Pause';
                playInterval = setInterval(function() {
                    let currentValue = parseInt(slider.value);
                    let maxValue = parseInt(slider.max);
                    if (currentValue >= maxValue) {
                        slider.value = 0; // Loop back to the start
                    } else {
                        slider.value = currentValue + 1;
                    }
                    slider.oninput();
                }, 200); // Change slice every 200 milliseconds
            }
        }
    </script>
</body>
</html>

